import {useState, useEffect} from 'react';
import nodes from '../data/pathNodes.js';
const useDirections = (currentRoom, findingRoom) => { //inputs are room nums

    const [directions, setDirections] = useState([]);


    useEffect(() => {
        const getDirections = async () => {
            

            const startRoom = nodes.find(node => node.properties.room.name === currentRoom);
            const endRoom = nodes.find(node => node.properties.room.name === findingRoom);
            console.log(startRoom);
            const queue = [startRoom];

            const visited = new Set();


            while(queue.length > 0){
                let room = queue.shift();
                
                const destinations = nodes.find(node => node.properties.room.name === room.properties.room.name).properties.room.otherNodes;
                
                for(const destination of destinations){
                    queue.push(destination);
                    if(destination === endRoom){
                        setDirections(queue);
                        break;
                    }
                    if(!visited.has(destination)){
                        visited.add(destination);
                        queue.push(destination);
                    }

                }

            }

        }   
        
        getDirections();

            const directionsObj = {
                type: 'Feature',
                properties: {},
                geometry: {
                    type: 'LineString',
                    coordinates: directions
                }
                
            }

            setDirections(directionsObj);


        }, [])

    return (directions)
}
 
export default useDirections;